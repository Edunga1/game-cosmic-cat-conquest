{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-248d45b26853c557.js","src/game/core/math/Point.ts","src/game/mobile/Attributes.ts","src/game/mobile/MobileCollection.ts","src/game/mobile/Mobile.ts","src/game/sprite/Sprite.ts","node_modules/@parcel/runtime-js/lib/runtime-d99662e4b0933e94.js","src/game/characters/Cat.ts","node_modules/@parcel/runtime-js/lib/runtime-54656b7000d933e5.js","src/game/characters/TargetPoint.ts","node_modules/@parcel/runtime-js/lib/runtime-5e9d9a7d7a650e2f.js","src/game/effects/SpriteEffectBase.ts","src/game/effects/ConfettiEffect.ts","src/game/space/Space.ts","src/game/characters/CirclingTriangle.ts","src/game/stage/GameLevel.ts","src/game/Game.ts","src/App.ts"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"67Pf5\\\":\\\"index.070fea97.js\\\",\\\"kp27Z\\\":\\\"cat-sprites-running.47e835c7.png\\\",\\\"1H4Ur\\\":\\\"cat-sprites-idle.8767d413.png\\\",\\\"7agUk\\\":\\\"confetti-sprites.0546130f.png\\\"}\"));","export default class Point {\n  constructor(\n    public x: number,\n    public y: number\n  ) {\n    this.x = x\n    this.y = y\n  }\n\n  static zero() {\n    return new Point(0, 0)\n  }\n\n  add(point: Point) {\n    return new Point(this.x + point.x, this.y + point.y)\n  }\n\n  subtract(point: Point) {\n    return new Point(this.x - point.x, this.y - point.y)\n  }\n\n  unit() {\n    const length = this.length()\n    if (length === 0) {\n      return Point.zero()\n    }\n    return new Point(this.x / length, this.y / length)\n  }\n\n  length() {\n    return Math.sqrt(this.x * this.x + this.y * this.y)\n  }\n\n  multiply(scalar: number) {\n    return new Point(this.x * scalar, this.y * scalar)\n  }\n\n  angle() {\n    return Math.atan2(this.y, this.x)\n  }\n\n  distanceTo(point: Point) {\n    return this.subtract(point).length()\n  }\n\n  limit(max: number) {\n    const length = this.length()\n    if (length > max) {\n      return this.unit().multiply(max)\n    }\n    return this\n  }\n\n  around(distance: number) {\n    const angle = Math.random() * Math.PI * 2\n    return new Point(\n      this.x + Math.cos(angle) * distance,\n      this.y + Math.sin(angle) * distance,\n    )\n  }\n}\n\n","export default class Attributes {\n  public hp = NumericAttribute.of(100)\n  public size = 1\n  public power = 0\n  public range = new NumericAttribute(1, 10)\n  public attackPeriod = 1000\n\n  damage(source: Attributes) {\n    this.hp.value -= source.power\n  }\n}\n\nclass NumericAttribute {\n  private _value: number\n  private _max: number\n\n  constructor(\n    value: number,\n    max: number,\n  ) {\n    this._value = value\n    this._max = max\n  }\n\n  static of(value: number) {\n    return new NumericAttribute(value, value)\n  }\n\n  set value(value: number) {\n    this._value = value\n    this._max = Math.max(value, this._max)\n  }\n\n  get value() {\n    return this._value\n  }\n\n  set max(max: number) {\n    this._max = max\n    this._value = Math.min(max, this._value)\n  }\n\n  get max() {\n    return this._max\n  }\n}\n","import Point from \"../core/math/Point\"\nimport Mobile from \"./Mobile\"\n\nexport default class MobileCollection {\n  collection: Mobile[] = []\n\n  get length() {\n    return this.collection.filter(mobile => mobile.isAlive).length\n  }\n\n  get first(): Mobile | undefined {\n    return this.collection[0]\n  }\n\n  includes(mobile: Mobile) {\n    return this.collection.includes(mobile)\n  }\n\n  add(mobile: Mobile) {\n    this.collection.push(mobile)\n  }\n\n  nearestMobilesInRange(position: Point, range: number): Mobile[] {\n    return this.collection.filter(mobile => {\n      return mobile.isAlive && mobile.position.distanceTo(position) < range\n    })\n  }\n}\n","import Point from \"../core/math/Point\"\nimport Attributes from \"./Attributes\"\nimport MobileCollection from \"./MobileCollection\"\n\nexport default abstract class Mobile {\n  position = Point.zero()\n  velocity = Point.zero()\n  speed = 1\n  direction = new Point(0, 0)\n  lifetime = 0\n  maxLifetime = Infinity\n  isLiving = true\n  attributes = new Attributes()\n  lastAttack = 0\n  isAlive = true\n  score = 0\n  fame = 0\n  appearanceSize = 1\n  enemies: MobileCollection = new MobileCollection()\n\n  onLifetimeEnd?: () => void\n  onDeath: ((mobile: Mobile) => void)[] = []\n\n  constructor(\n    protected context: CanvasRenderingContext2D,\n  ) { }\n\n  update(delta: number) {\n    this.updateEssentials(delta)\n    this.afterUpdate()\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  render(_delta: number) { /** implement in child */ }\n\n  move(distance: Point) {\n    this.velocity = distance.limit(this.speed)\n    this.direction = distance\n  }\n\n  moveToMobile(target: Mobile) {\n    const distance = target.position.subtract(this.position)\n    if (distance.length() < target.attributes.size) {\n      this.stop()\n      return\n    }\n    const margin = distance.unit().multiply(target.attributes.size)\n    const dest = distance.subtract(margin)\n    this.move(dest)\n  }\n\n  stop() {\n    this.velocity = Point.zero()\n  }\n\n  attack(targets: Mobile[]): boolean {\n    if (this.lastAttack < this.attributes.attackPeriod) {\n      return false\n    }\n\n    const targetsInRange = targets.filter(t =>\n      this.attributes.range.value >= this.position.distanceTo(t.position) - t.attributes.size\n    )\n\n    if (targetsInRange.length === 0) {\n      return false\n    }\n\n    this.lastAttack = 0\n    this.direction = targets[0].position.subtract(this.position)\n    targets.forEach(target => target.damage(this.attributes.power))\n      \n    return true\n  }\n\n  attackDirection(direction: Point): boolean {\n    const attackPoint = this.position.add(direction.unit().multiply(this.attributes.range.value))\n    const targets = this.enemies.nearestMobilesInRange(attackPoint, this.attributes.range.value)\n    const result = this.attack(targets)\n    this.direction = direction.unit()\n    return result\n  }\n\n  isOpponent(mobile: Mobile): boolean {\n    return this.enemies.includes(mobile)\n  }\n\n  scoreByMobile(mobile: Mobile) {\n    this.score += mobile.fame\n  }\n\n  protected checkLifetimeEnd(): boolean {\n    return this.lifetime > this.maxLifetime\n  }\n\n  protected afterUpdate() { /** implement in child */ }\n\n  private updateEssentials(delta: number) {\n    this.lifetime += delta\n    this.lastAttack += delta\n    this.position = this.position.add(this.velocity.multiply(delta / 5))\n\n    // notify when lifetime is over\n    if (this.checkLifetimeEnd()) {\n      this.onLifetimeEnd?.()\n    }\n  }\n\n  private damage(damage: number) {\n    this.attributes.hp.value -= damage\n    if (this.attributes.hp.value <= 0) {\n      this.die()\n    }\n  }\n\n  private die() {\n    this.isAlive = false\n    this.onDeath.forEach(callback => callback(this))\n  }\n}\n","import Point from \"../core/math/Point\"\n\nexport default class Sprite {\n  frameIndex = 0\n  time = 0\n  framesPerRow = 0\n  imageLoaded = false\n  loopCount = 0\n\n  constructor(\n    private image: HTMLImageElement,\n    private frameWidth: number,\n    private frameHeight: number,\n    private framesPerSecond = 60,\n    private loop = true,\n  ) {\n    this.image.onload = () => {\n      this.imageLoaded = true\n      this.framesPerRow = Math.floor(image.width / frameWidth)\n    }\n  }\n\n  update(dt: number) {\n    if (!this.checkLoop()) return\n    this.time += dt\n    while (this.time > 1000/this.framesPerSecond) {\n      this.time -= 1000/this.framesPerSecond\n      this.frameIndex++\n      if (this.frameIndex >= this.framesPerRow * Math.floor(this.image.height / this.frameHeight)) {\n        this.frameIndex = 0\n        this.loopCount++\n      }\n    }\n  }\n\n  draw(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    direction: Point = Point.zero(),\n  ) {\n    if (!this.checkLoop()) return\n    if (!this.imageLoaded) return\n\n    const row = Math.floor(this.frameIndex / this.framesPerRow)\n    const col = this.frameIndex % this.framesPerRow\n    // sprite is facing left by default\n    const flip = direction.x < 0 ? 1 : -1\n\n    ctx.save()\n    ctx.scale(flip, 1)\n    ctx.drawImage(\n      this.image,\n      col * this.frameWidth,\n      row * this.frameHeight,\n      this.frameWidth,\n      this.frameHeight,\n      x - this.frameWidth / 2,\n      y - this.frameHeight / 2,\n      this.frameWidth,\n      this.frameHeight\n    )\n    ctx.restore()\n  }\n\n  private checkLoop(): boolean {\n    return this.loop || this.loopCount === 0\n  }\n}\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"kp27Z\")).toString();","import Mobile from \"../mobile/Mobile\"\nimport Sprite from \"../sprite/Sprite\"\nimport CatRunningSprite from \"../../../assets/images/cat-sprites-running.png\"\nimport CatIdleSprite from \"../../../assets/images/cat-sprites-idle.png\"\nimport Point from \"../core/math/Point\"\n\nenum Mode {\n  IDLE,\n  RUNNING,\n}\n\nexport default class Cat extends Mobile {\n  private sprites: Map<Mode, Sprite> = new Map()\n  private mode = Mode.IDLE\n\n  static SPRITES = [\n    { mode: Mode.IDLE, img: CatIdleSprite, width: 20, height: 15, fps: 5 },\n    { mode: Mode.RUNNING, img: CatRunningSprite, width: 22, height: 16, fps: 10 },\n  ]\n\n  constructor(\n    context: CanvasRenderingContext2D\n  ) {\n    super(context)\n\n    this.attributes.hp.max = 50\n    this.attributes.power = 5\n    this.attributes.size = 10\n    this.attributes.range.value = 50\n    this.attributes.range.max = 50\n    this.attributes.attackPeriod = 0\n    this.appearanceSize = 10\n\n    Cat.SPRITES.forEach(({ mode, img, width, height, fps }) => {\n      const image = new Image()\n      image.src = img\n      this.sprites.set(mode, new Sprite(image, width, height, fps))\n    })\n  }\n\n  render(delta: number) {\n    const sprite = this.sprites.get(this.mode)\n    sprite?.update(delta)\n    sprite?.draw(this.context, 0, 0, this.direction)\n  }\n\n  move(distance: Point) {\n    super.move(distance)\n    this.mode = Mode.RUNNING\n  }\n\n  stop() {\n    super.stop()\n    this.mode = Mode.IDLE\n    this.attackDirection(this.direction)\n  }\n}\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"1H4Ur\")).toString();","import Mobile from \"../mobile/Mobile\"\n\nexport default class TargetPoint extends Mobile {\n  private visible = true\n\n  constructor(\n    context: CanvasRenderingContext2D,\n    private source: Mobile,\n  ) {\n    super(context)\n    this.isLiving = false\n  }\n\n  setVisible(visible: boolean) {\n    this.visible = visible\n  }\n\n  render() {\n    if (!this.visible) {\n      return\n    }\n    const dist = this.source.position.subtract(this.position)\n    this.context.beginPath()\n    this.context.moveTo(0, 0)\n    this.context.lineTo(dist.x, dist.y)\n    this.context.strokeStyle = '#FFF'\n    this.context.setLineDash([5, 15])\n    this.context.stroke()\n  }\n}\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"7agUk\")).toString();","import Mobile from \"../mobile/Mobile\";\nimport Sprite from \"../sprite/Sprite\";\n\n\nexport default abstract class SpriteEffectBase extends Mobile {\n\n  constructor(\n    context: CanvasRenderingContext2D,\n    private sprite: Sprite\n  ) {\n    super(context)\n    this.isLiving = false\n  }\n\n  render(delta: number): void {\n    this.sprite.update(delta)\n    this.sprite.draw(this.context, 0, 0, this.direction)\n  }\n\n  protected checkLifetimeEnd(): boolean {\n    return this.sprite.loopCount > 0\n  }\n}\n","import Sprite from \"../sprite/Sprite\"\nimport EffectSprite from \"../../../assets/images/confetti-sprites.png\"\nimport SpriteEffectBase from \"./SpriteEffectBase\"\n\nexport default class ConfettiEffect extends SpriteEffectBase {\n  constructor(\n    context: CanvasRenderingContext2D\n  ) {\n    const image = new Image()\n    image.src = EffectSprite\n    const sprite = new Sprite(image, 81, 81, 10, false)\n    super(context, sprite)\n  }\n\n  render(delta: number): void {\n    this.context.save()\n    const gap = this.direction.unit().multiply(30)\n    this.context.translate(gap.x, gap.y)\n    // sprite is facing left, so rotate 90 degrees to face up\n    this.context.rotate(this.direction.angle() + Math.PI / 2)\n    super.render(delta)\n    this.context.restore()\n  }\n}\n","import Point from \"../core/math/Point\"\n\nexport default class Space {\n  width = 0\n  height = 0\n  starElapsed = 0\n  backgroundColor = \"rgb(10, 10, 10)\"\n  stars: Point[] = []\n  initialStars = 100\n  maxStars = 400\n\n  constructor(\n    private context: CanvasRenderingContext2D\n  ) {\n    for (let i = 0; i < this.initialStars; i++) {\n      this.createStar()\n    }\n  }\n\n  animate(delta: number) {\n    this.render(delta)\n  }\n\n  resize(width: number, height: number) {\n    this.width = width\n    this.height = height\n    this.stars.forEach(star => {\n      star.x = Math.random() * width\n      star.y = Math.random() * height\n    })\n  }\n\n  createStar() {\n    this.stars.push(new Point(\n      Math.random() * this.width,\n      Math.random() * this.height,\n    ))\n  }\n\n  private render(delta: number) {\n    this.renderBackground()\n    this.renderStars()\n\n    if (this.checkStarElapsed(delta)) {\n      this.updateStars(delta)\n    }\n  }\n\n  private renderBackground() {\n    this.context.fillStyle = this.backgroundColor\n    this.context.fillRect(0, 0, this.width, this.height)\n  }\n\n  private renderStars() {\n    this.context.fillStyle = \"white\"\n    this.stars.forEach(star => {\n      this.context.fillRect(star.x, star.y, 1, 1)\n    })\n  }\n\n  private updateStars(delta: number) {\n    this.stars.forEach(star => {\n      star.x += (Math.random() - .5) * delta\n      star.y += (Math.random() - .5) * delta\n    })\n  }\n\n  private checkStarElapsed(delta: number) {\n    this.starElapsed += delta\n    if (this.starElapsed > 200) {\n      this.starElapsed = 0\n      return true\n    }\n    return false\n  }\n}\n","import Mobile from \"../mobile/Mobile\"\n\nexport default class CirclingTriangle extends Mobile {\n  private rgb = {\n    r: 255,\n    g: 0,\n    b: 0,\n  }\n\n  constructor(\n    context: CanvasRenderingContext2D\n  ) {\n    super(context)\n\n    this.attributes.hp.max = 5\n    this.attributes.power = 1\n    this.attributes.size = 1\n    this.speed = .5\n    this.fame = 1\n    this.appearanceSize = 7\n  }\n\n  render(): void {\n    this.context.save()\n    this.context.rotate(this.direction.angle() + Math.PI / 2)\n    this.context.beginPath()\n    this.context.moveTo(0, -5)\n    this.context.lineTo(5, 5)\n    this.context.lineTo(0, 3)\n    this.context.lineTo(-5, 5)\n    this.context.lineTo(0, -5)\n    this.context.fillStyle = `rgb(${this.rgb.r}, ${this.rgb.g}, ${this.rgb.b})`\n    this.context.fill()\n    this.context.restore()\n    // attacking effect\n    if (this.lastAttack > 200) return\n    this.context.save()\n    this.context.rotate(this.direction.angle() + Math.PI / 2)\n    this.context.beginPath()\n    this.context.moveTo(0, -4)\n    this.context.lineTo(4, 4)\n    this.context.lineTo(0, 2)\n    this.context.lineTo(-4, 4)\n    this.context.lineTo(0, -4)\n    this.context.fillStyle = `rgb(${this.rgb.r}, ${this.rgb.g}, ${this.rgb.b}, ${this.lastAttack / 200})`\n    this.context.fill()\n    this.context.restore()\n  }\n\n  addBlue(): void {\n    this.rgb.b += 100\n  }\n\n  addGreen(): void {\n    this.rgb.g += 100\n  }\n\n  protected afterUpdate(): void {\n    if (this.enemies.first === undefined) return\n    this.moveToMobile(this.enemies.first)\n    this.attack([this.enemies.first])\n  }\n}\n","import CirclingTriangle from \"../characters/CirclingTriangle\"\nimport Game from \"../Game\"\n\nexport default class GameLevel {\n  private maxEnemies = 50\n  private currentLevel = 1\n\n  constructor(\n    private game: Game,\n  ) {\n  }\n\n  update(): void {\n    this.createEnemy()\n  }\n\n  private createEnemy() {\n    this.updateCurrentLevel()\n\n    if (!this.game.player) return\n    if (this.game.player.enemies.length >= this.maxEnemies) return\n\n    this.createEnemyByLevel()\n  }\n\n  private updateCurrentLevel() {\n    this.currentLevel = Math.floor(this.game.lifeTime / 10000) + 1\n  }\n\n  private createEnemyByLevel() {\n    const enemy = new CirclingTriangle(this.game.context)\n\n    if (this.currentLevel >= 3) {\n      enemy.addGreen()\n    } else if (this.currentLevel >= 2) {\n      enemy.addBlue()\n    }\n\n    this.game.createEnemy(enemy)\n  }\n}\n","import Cat from \"./characters/Cat\"\nimport TargetPoint from \"./characters/TargetPoint\"\nimport Point from \"./core/math/Point\"\nimport ConfettiEffect from \"./effects/ConfettiEffect\"\nimport Mobile from \"./mobile/Mobile\"\nimport Space from \"./space/Space\"\nimport GameLevel from \"./stage/GameLevel\"\n\nexport default class Game {\n  options = {\n    showCoordinates: false,\n  }\n  width = 0\n  height = 0\n  lifeTime = 0\n  delta = 0\n  paused = false\n  space?: Space = undefined\n  player?: Mobile = undefined\n  targetPoint?: TargetPoint = undefined\n  mobiles: Mobile[] = []\n  gameLevel = new GameLevel(this)\n  pausedTitle?: string = undefined\n  pausedSubtitle?: string = undefined\n\n  constructor(\n    public context: CanvasRenderingContext2D,\n  ) {\n    this.reset()\n  }\n\n  resize(width: number, height: number) {\n    this.width = width\n    this.height = height\n    this.space?.resize(width, height)\n  }\n\n  animate(time: number) {\n    this.updateDelta(time)\n    this.renderSpace()\n    this.renderInterface()\n\n    if (this.paused) {\n      this.renderPauseMessage()\n      return\n    }\n\n    this.updateGameLevel()\n    this.updateMobiles()\n    this.processGameOver()\n\n    this.renderMobiles()\n  }\n\n  movePlayer(x: number, y: number) {\n    if (!this.player) return\n\n    const distance = new Point(x, y)\n    this.player.move(distance)\n\n    if (!this.targetPoint) return\n\n    this.targetPoint.position = this.player.position.add(distance)\n    this.targetPoint?.setVisible(true)\n  }\n\n  stopPlayer() {\n    this.player?.stop()\n    this.targetPoint?.setVisible(false)\n    this.createCatAttackEffect()\n  }\n\n  getSummary() {\n    return `\n      Player:\n        * pos: ${this.player?.position.x}, ${this.player?.position.y}\n        * hp : ${this.player?.attributes.hp.value} / ${this.player?.attributes.hp.max}\n        * score: ${this.player?.score}\n      Mobiles: ${this.mobiles?.length}\n    `\n  }\n\n  createEnemy(mobile: Mobile) {\n    this.mobiles.push(mobile)\n\n    if (!this.player) return\n\n    mobile.position = this.player?.position.around(Math.random() * 200 + 400)\n    mobile.enemies.add(this.player)\n    mobile.onDeath.push(this.scoreToPlayer.bind(this))\n    mobile.onDeath.push(this.addStarToSpace.bind(this))\n    this.player?.enemies.add(mobile)\n  }\n\n  pause(title?: string, subtitle?: string) {\n    this.pausedTitle = title\n    this.pausedSubtitle = subtitle\n    this.paused = true\n  }\n\n  resume() {\n    this.paused = false\n  }\n\n  reset() {\n    this.mobiles = []\n    this.space = new Space(this.context)\n    this.space.resize(this.width, this.height)\n    this.player = new Cat(this.context)\n    this.mobiles.push(this.player)\n    this.targetPoint = new TargetPoint(this.context, this.player)\n    this.mobiles.push(this.targetPoint)\n    this.resume()\n  }\n\n  private processGameOver() {\n    if (this.player?.isAlive) return\n    this.pause(\"GAME OVER\", \"Press any key to restart\")\n  }\n\n  private updateMobiles() {\n    this.mobiles.forEach(mobile => mobile.update(this.delta))\n  }\n\n  private renderMobiles() {\n    const aliveMobiles = this.mobiles.filter(mobile => mobile.isAlive)\n    const axis = this.player?.position || new Point(0, 0)\n    aliveMobiles.forEach(enemy => {\n      this.context.save()\n      this.context.translate(\n        this.width / 2 - axis.x + enemy.position.x,\n        this.height / 2 - axis.y + enemy.position.y,\n      )\n      enemy.render(this.delta)\n      this.drawCoordinates(enemy)\n      this.context.restore()\n    })\n  }\n\n  private updateGameLevel() {\n    this.gameLevel.update()\n  }\n\n  private updateDelta(time: number) {\n    this.delta = time - this.lifeTime\n    this.lifeTime = time\n  }\n\n  private createCatAttackEffect() {\n    if (!this.player) return\n    const effect = new ConfettiEffect(this.context)\n    effect.position = this.player.position\n    effect.direction = this.player.direction\n    effect.onLifetimeEnd = () => {\n      this.mobiles.splice(this.mobiles.indexOf(effect), 1)\n    }\n    this.mobiles.push(effect)\n  }\n\n  private drawCoordinates(mobile: Mobile) {\n    if (!this.options.showCoordinates || !mobile.isLiving) {\n      return\n    }\n    const size = mobile.appearanceSize\n    this.context.fillStyle = \"white\"\n    this.context.font = `${size}px Arial`\n    const text = `${Math.round(mobile.position.x)}, ${Math.round(mobile.position.y)}`\n    const left = text.length / 4 * size\n    this.context.fillText(text, -left, size * 2)\n  }\n\n  private scoreToPlayer(mobile: Mobile) {\n    this.player?.scoreByMobile(mobile)\n  }\n\n  private addStarToSpace() {\n    this.space?.createStar()\n  }\n\n  private renderSpace() {\n    if (!this.space) return\n    this.space.animate(this.delta)\n  }\n\n  private renderInterface() {\n    if (!this.player) return\n    this.context.save()\n    this.context.fillStyle = \"white\"\n    this.context.font = \"16px Courier\"\n    this.context.fillText(this.player.score.toString(), this.width / 2, 20)\n    this.context.restore()\n  }\n\n  private renderPauseMessage() {\n    if (!this.pausedTitle) return\n    this.context.save()\n    this.context.fillStyle = \"white\"\n    this.context.font = \"48px Courier\"\n    this.context.textAlign = \"center\"\n    const text = this.pausedTitle\n    this.context.fillText(text, this.width / 2, this.height / 2)\n    this.context.restore()\n    if (!this.pausedSubtitle) return\n    this.context.save()\n    this.context.fillStyle = \"white\"\n    this.context.font = \"16px Courier\"\n    this.context.textAlign = \"center\"\n    const subtitle = this.pausedSubtitle\n    this.context.fillText(subtitle, this.width / 2, this.height / 2 + 48)\n    this.context.restore()\n  }\n}\n","import Point from \"./game/core/math/Point\"\nimport Game from \"./game/Game\"\n\nexport class App {\n  canvas: HTMLCanvasElement\n  context: CanvasRenderingContext2D\n  game: Game\n  width = 0\n  height = 0\n  isControllingPlayer = false\n  keys: string[] = []\n\n  constructor() {\n    this.canvas = document.createElement(\"canvas\")\n    const context = this.canvas.getContext(\"2d\")\n    if (!context) {\n      throw new Error(\"Could not get canvas context\")\n    }\n    this.context = context\n    this.game = new Game(this.context)\n  }\n\n  start() {\n    document.body.appendChild(this.canvas)\n    window.addEventListener(\"resize\", this.resize.bind(this))\n    this.registerCanvasEvents()\n    this.resize()\n    this.registerConsoleCommands()\n    requestAnimationFrame(this.animate.bind(this))\n  }\n\n  enableDebugMode(): App {\n    setInterval(() => {\n      console.log(this.game.getSummary())\n    }, 3000)\n    return this\n  }\n\n  private animate(timestamp: number) {\n    this.game.animate(timestamp)\n    requestAnimationFrame(this.animate.bind(this))\n  }\n\n  private resize() {\n    this.width = document.body.clientWidth\n    this.height = document.body.clientHeight\n    this.canvas.width = this.width\n    this.canvas.height = this.height\n\n    this.game.resize(this.width, this.height)\n  }\n\n  private registerCanvasEvents() {\n    this.canvas.addEventListener(\"mousedown\", this.onMouseDown.bind(this))\n    this.canvas.addEventListener(\"mousemove\", this.onMouseMove.bind(this))\n    this.canvas.addEventListener(\"mouseup\", this.onTouchEnd.bind(this))\n    this.canvas.addEventListener(\"touchstart\", this.onTouchStart.bind(this))\n    this.canvas.addEventListener(\"touchmove\", this.onTouchStart.bind(this))\n    this.canvas.addEventListener(\"touchend\", this.onTouchEnd.bind(this))\n    document.addEventListener(\"keydown\", this.onKeyDown.bind(this))\n    document.addEventListener(\"keyup\", this.onKeyUp.bind(this))\n  }\n\n  private registerConsoleCommands() {\n    const commands: Record<string, () => void> = {\n      \"toggle coordinates\": () => {\n        this.game.options.showCoordinates = !this.game.options.showCoordinates\n      }\n    }\n\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    window.run = (command: string) => {\n      const key = Object.keys(commands).find(key => key.startsWith(command))\n      if (!key) {\n        console.log(\"No command found\")\n        return\n      }\n      console.log(`Executed: ${key}`)\n      commands[key]()\n    }\n  }\n\n  private movePlayer(x: number, y: number) {\n    if (this.game.player?.isAlive === false && !this.isControllingPlayer) {\n      this.game.reset()\n    }\n    this.isControllingPlayer = true\n    this.game.movePlayer(x, y)\n  }\n\n  private endMovePlayer() {\n    this.isControllingPlayer = false\n    this.game.stopPlayer()\n  }\n\n  private onMouseDown(event: MouseEvent) {\n    this.movePlayer(\n      ...this.calculateDistanceFromCenter(event.clientX, event.clientY)\n    )\n  }\n\n  private onMouseMove(event: MouseEvent) {\n    if (event.buttons === 0)\n      return\n    this.movePlayer(\n      ...this.calculateDistanceFromCenter(event.clientX, event.clientY)\n    )\n  }\n\n  private onTouchStart(event: TouchEvent) {\n    this.movePlayer(\n      ...this.calculateDistanceFromCenter(event.touches[0].clientX, event.touches[0].clientY)\n    )\n  }\n\n  private onTouchEnd() {\n    this.endMovePlayer()\n  }\n\n  private calculateDistanceFromCenter(x: number, y: number): [number, number] {\n    const center = new Point(this.width / 2, this.height / 2)\n    const point = new Point(x, y)\n    const distance = point.subtract(center)\n    return [distance.x, distance.y]\n  }\n\n  private onKeyDown(event: KeyboardEvent) {\n    if (!(event.key in App.KEY_TO_DIRECTION)) {\n      return\n    }\n    if (this.keys.includes(event.key)) {\n      return\n    }\n    this.keys.push(event.key)\n    this.updateKeys()\n  }\n\n  private onKeyUp(event: KeyboardEvent) {\n    if (!(event.key in App.KEY_TO_DIRECTION)) {\n      return\n    }\n    this.keys = this.keys.filter(key => key !== event.key)\n    this.updateKeys()\n  }\n\n  private updateKeys() {\n    if (this.keys.length === 0) {\n      this.endMovePlayer()\n      return\n    }\n    const sum = this.keys.reduce((sum, key) => {\n      return [sum[0] + App.KEY_TO_DIRECTION[key][0], sum[1] + App.KEY_TO_DIRECTION[key][1]]\n    }, [0, 0])\n    this.movePlayer(sum[0], sum[1])\n  }\n\n  static KEY_TO_DIRECTION: { [key: string]: [number, number] } = {\n    \"w\": [0, -1],\n    \"a\": [-1, 0],\n    \"s\": [0, 1],\n    \"d\": [1, 0],\n    \"ArrowUp\": [0, -1],\n    \"ArrowLeft\": [-1, 0],\n    \"ArrowDown\": [0, 1],\n    \"ArrowRight\": [1, 0],\n  }\n}\n\nnew App().enableDebugMode().start()\n"],"names":["$18c11f3350a906ea$export$6503ec6e8aabbaf","$18c11f3350a906ea$export$f7ad0328861e2f03","$18c11f3350a906ea$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$43bfe6294afb6043$export$2e2bcd8739ae039","constructor","x","y","this","static","add","point","subtract","unit","zero","Math","sqrt","multiply","scalar","angle","atan2","distanceTo","limit","max","around","distance","random","PI","cos","sin","$6bfbb6c15128e9b5$export$2e2bcd8739ae039","hp","$6bfbb6c15128e9b5$var$NumericAttribute","of","size","power","range","attackPeriod","damage","source","value","_value","_max","min","$e17df336da1b3802$export$2e2bcd8739ae039","collection","filter","mobile","isAlive","first","includes","push","nearestMobilesInRange","position","$73c3f5d8867f376c$export$2e2bcd8739ae039","context","velocity","speed","direction","lifetime","maxLifetime","Infinity","isLiving","attributes","lastAttack","score","fame","appearanceSize","enemies","onDeath","update","delta","updateEssentials","afterUpdate","render","_delta","move","moveToMobile","target","stop","margin","dest","attack","targets","t","forEach","attackDirection","attackPoint","result","isOpponent","scoreByMobile","checkLifetimeEnd","onLifetimeEnd","die","callback","$da5fc1c35aff1e0d$export$2e2bcd8739ae039","image","frameWidth","frameHeight","framesPerSecond","loop","frameIndex","time","framesPerRow","imageLoaded","loopCount","onload","floor","width","dt","checkLoop","height","draw","ctx","row","col","flip","save","scale","drawImage","restore","$e2c9dcac0f02a629$exports","URL","resolve","import","meta","url","toString","$85c94ce00cb2a82b$var$Mode","Mode","$7357178c6a7828df$exports","$85c94ce00cb2a82b$export$2e2bcd8739ae039","sprites","Map","mode","IDLE","img","$parcel$interopDefault","fps","RUNNING","super","SPRITES","Image","src","set","sprite","get","$593fdb6cc61fd03e$export$2e2bcd8739ae039","visible","setVisible","dist","beginPath","moveTo","lineTo","strokeStyle","setLineDash","stroke","$1d5b3938f41b967b$exports","$1f66de5e70c11fdb$export$2e2bcd8739ae039","$8f889751dfd7c577$export$2e2bcd8739ae039","gap","translate","rotate","$f8daf18d7ca6e6d0$export$2e2bcd8739ae039","starElapsed","backgroundColor","stars","initialStars","maxStars","createStar","animate","resize","star","renderBackground","renderStars","checkStarElapsed","updateStars","fillStyle","fillRect","$1680c37e97ccc699$export$2e2bcd8739ae039","rgb","r","g","b","fill","addBlue","addGreen","undefined","$2db6e0bd5690816b$export$2e2bcd8739ae039","game","maxEnemies","currentLevel","createEnemy","updateCurrentLevel","player","createEnemyByLevel","lifeTime","enemy","$1d65543a723a8bec$export$2e2bcd8739ae039","options","showCoordinates","paused","space","targetPoint","mobiles","gameLevel","pausedTitle","pausedSubtitle","reset","updateDelta","renderSpace","renderInterface","renderPauseMessage","updateGameLevel","updateMobiles","processGameOver","renderMobiles","movePlayer","stopPlayer","createCatAttackEffect","getSummary","scoreToPlayer","bind","addStarToSpace","pause","title","subtitle","resume","aliveMobiles","axis","drawCoordinates","effect","splice","indexOf","font","text","round","left","fillText","textAlign","$2ae89aad8d89d959$export$86fbec116b87613f","isControllingPlayer","canvas","document","createElement","getContext","start","body","appendChild","window","addEventListener","registerCanvasEvents","registerConsoleCommands","requestAnimationFrame","enableDebugMode","setInterval","console","log","timestamp","clientWidth","clientHeight","onMouseDown","onMouseMove","onTouchEnd","onTouchStart","onKeyDown","onKeyUp","commands","run","command","key","find","startsWith","endMovePlayer","event","calculateDistanceFromCenter","clientX","clientY","buttons","touches","center","KEY_TO_DIRECTION","updateKeys","sum","reduce","w","a","s","d","ArrowUp","ArrowLeft","ArrowDown","ArrowRight"],"version":3,"file":"index.070fea97.js.map"}