{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-248d45b26853c557.js","src/game/core/math/Point.ts","src/game/mobile/Attributes.ts","src/game/mobile/MobileCollection.ts","src/game/mobile/Mobile.ts","src/game/sprite/Sprite.ts","node_modules/@parcel/runtime-js/lib/runtime-d99662e4b0933e94.js","src/game/characters/Cat.ts","node_modules/@parcel/runtime-js/lib/runtime-54656b7000d933e5.js","src/game/characters/CirclingTriangle.ts","src/game/characters/TargetPoint.ts","node_modules/@parcel/runtime-js/lib/runtime-5e9d9a7d7a650e2f.js","src/game/effects/SpriteEffectBase.ts","src/game/effects/ConfettiEffect.ts","src/game/space/Space.ts","src/game/stage/GameLevel.ts","src/game/Game.ts","src/App.ts"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"67Pf5\\\":\\\"index.248050c4.js\\\",\\\"kp27Z\\\":\\\"cat-sprites-running.47e835c7.png\\\",\\\"1H4Ur\\\":\\\"cat-sprites-idle.8767d413.png\\\",\\\"7agUk\\\":\\\"confetti-sprites.0546130f.png\\\"}\"));","export default class Point {\n  constructor(\n    public x: number,\n    public y: number\n  ) {\n    this.x = x\n    this.y = y\n  }\n\n  static zero() {\n    return new Point(0, 0)\n  }\n\n  add(point: Point) {\n    return new Point(this.x + point.x, this.y + point.y)\n  }\n\n  subtract(point: Point) {\n    return new Point(this.x - point.x, this.y - point.y)\n  }\n\n  unit() {\n    const length = this.length()\n    if (length === 0) {\n      return Point.zero()\n    }\n    return new Point(this.x / length, this.y / length)\n  }\n\n  length() {\n    return Math.sqrt(this.x * this.x + this.y * this.y)\n  }\n\n  multiply(scalar: number) {\n    return new Point(this.x * scalar, this.y * scalar)\n  }\n\n  angle() {\n    return Math.atan2(this.y, this.x)\n  }\n\n  distanceTo(point: Point) {\n    return this.subtract(point).length()\n  }\n\n  limit(max: number) {\n    const length = this.length()\n    if (length > max) {\n      return this.unit().multiply(max)\n    }\n    return this\n  }\n}\n\n","export default class Attributes {\n  public hp = NumericAttribute.of(100)\n  public size = 1\n  public power = 0\n  public range = new NumericAttribute(1, 10)\n  public attackPeriod = 1000\n\n  damage(source: Attributes) {\n    this.hp.value -= source.power\n  }\n}\n\nclass NumericAttribute {\n  private _value: number\n  private _max: number\n\n  constructor(\n    value: number,\n    max: number,\n  ) {\n    this._value = value\n    this._max = max\n  }\n\n  static of(value: number) {\n    return new NumericAttribute(value, value)\n  }\n\n  set value(value: number) {\n    this._value = value\n    this._max = Math.max(value, this._max)\n  }\n\n  get value() {\n    return this._value\n  }\n\n  set max(max: number) {\n    this._max = max\n    this._value = Math.min(max, this._value)\n  }\n\n  get max() {\n    return this._max\n  }\n}\n","import Point from \"../core/math/Point\"\nimport Mobile from \"./Mobile\"\n\nexport default class MobileCollection {\n  collection: Mobile[] = []\n\n  get length() {\n    return this.collection.filter(mobile => mobile.isAlive).length\n  }\n\n  get first(): Mobile | null {\n    return this.collection[0]\n  }\n\n  includes(mobile: Mobile) {\n    return this.collection.includes(mobile)\n  }\n\n  add(mobile: Mobile) {\n    this.collection.push(mobile)\n  }\n\n  nearestMobilesInRange(position: Point, range: number): Mobile[] {\n    return this.collection.filter(mobile => {\n      return mobile.isAlive && mobile.position.distanceTo(position) < range\n    })\n  }\n}\n","import Point from \"../core/math/Point\"\nimport Attributes from \"./Attributes\"\nimport MobileCollection from \"./MobileCollection\"\n\nexport default abstract class Mobile {\n  position = Point.zero()\n  velocity = Point.zero()\n  speed = 1\n  direction = new Point(0, 0)\n  lifetime = 0\n  maxLifetime = Infinity\n  isLiving = true\n  onLifetimeEnd?: () => void\n  attributes = new Attributes()\n  lastAttack = 0\n  isAlive = true\n  enemies: MobileCollection = new MobileCollection()\n\n  constructor(\n    protected context: CanvasRenderingContext2D,\n  ) {}\n\n  animate(delta: number) {\n    this.updateEssentials(delta)\n    this.update(delta)\n    this.render(delta)\n  }\n\n  move(distance: Point) {\n    this.velocity = distance.limit(this.speed)\n    this.direction = distance\n  }\n\n  moveToMobile(target: Mobile) {\n    const distance = target.position.subtract(this.position)\n    if (distance.length() < target.attributes.size) {\n      this.stop()\n      return\n    }\n    const margin = distance.unit().multiply(target.attributes.size)\n    const dest = distance.subtract(margin)\n    this.move(dest)\n  }\n\n  stop() {\n    this.velocity = Point.zero()\n  }\n\n  attack(target: Mobile) {\n    if (this.lastAttack < this.attributes.attackPeriod) {\n      return\n    }\n\n    if (this.attributes.range.value < this.position.distanceTo(target.position) - target.attributes.size) {\n      return\n    }\n\n    this.lastAttack = 0\n    this.direction = target.position.subtract(this.position)\n    target.damage(this.attributes.power)\n  }\n\n  isOpponent(mobile: Mobile): boolean {\n    return this.enemies.includes(mobile)\n  }\n\n  private updateEssentials(delta: number) {\n    this.lifetime += delta\n    this.lastAttack += delta\n    this.position = this.position.add(this.velocity.multiply(delta / 5))\n    // notify when lifetime is over\n    if (this.checkLifetimeEnd()) {\n      this.onLifetimeEnd?.()\n    }\n  }\n\n  private damage(damage: number) {\n    this.attributes.hp.value -= damage\n    if (this.attributes.hp.value <= 0) {\n      this.isAlive = false\n    }\n  }\n\n  protected checkLifetimeEnd(): boolean {\n    return this.lifetime > this.maxLifetime\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected update(_: number): void { /* empty */ }\n\n  protected abstract render(delta: number): void\n}\n","import Point from \"../core/math/Point\"\n\nexport default class Sprite {\n  frameIndex = 0\n  time = 0\n  framesPerRow = 0\n  imageLoaded = false\n  loopCount = 0\n\n  constructor(\n    private image: HTMLImageElement,\n    private frameWidth: number,\n    private frameHeight: number,\n    private framesPerSecond = 60,\n    private loop = true,\n  ) {\n    this.image.onload = () => {\n      this.imageLoaded = true\n      this.framesPerRow = Math.floor(image.width / frameWidth)\n    }\n  }\n\n  update(dt: number) {\n    if (!this.checkLoop()) return\n    this.time += dt\n    while (this.time > 1000/this.framesPerSecond) {\n      this.time -= 1000/this.framesPerSecond\n      this.frameIndex++\n      if (this.frameIndex >= this.framesPerRow * Math.floor(this.image.height / this.frameHeight)) {\n        this.frameIndex = 0\n        this.loopCount++\n      }\n    }\n  }\n\n  draw(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    direction: Point = Point.zero(),\n  ) {\n    if (!this.checkLoop()) return\n    if (!this.imageLoaded) return\n\n    const row = Math.floor(this.frameIndex / this.framesPerRow)\n    const col = this.frameIndex % this.framesPerRow\n    // sprite is facing left by default\n    const flip = direction.x < 0 ? 1 : -1\n\n    ctx.save()\n    ctx.scale(flip, 1)\n    ctx.drawImage(\n      this.image,\n      col * this.frameWidth,\n      row * this.frameHeight,\n      this.frameWidth,\n      this.frameHeight,\n      x - this.frameWidth / 2,\n      y - this.frameHeight / 2,\n      this.frameWidth,\n      this.frameHeight\n    )\n    ctx.restore()\n  }\n\n  private checkLoop(): boolean {\n    return this.loop || this.loopCount === 0\n  }\n}\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"kp27Z\")).toString();","import Mobile from \"../mobile/Mobile\"\nimport Sprite from \"../sprite/Sprite\"\nimport CatRunningSprite from \"../../../assets/images/cat-sprites-running.png\"\nimport CatIdleSprite from \"../../../assets/images/cat-sprites-idle.png\"\nimport Point from \"../core/math/Point\"\n\nenum Mode {\n  IDLE,\n  RUNNING,\n}\n\nexport default class Cat extends Mobile {\n  private sprites: Map<Mode, Sprite> = new Map()\n  private mode = Mode.IDLE\n\n  static SPRITES = [\n    { mode: Mode.IDLE, img: CatIdleSprite, width: 20, height: 15, fps: 5 },\n    { mode: Mode.RUNNING, img: CatRunningSprite, width: 22, height: 16, fps: 10 },\n  ]\n\n  constructor(\n    context: CanvasRenderingContext2D\n  ) {\n    super(context)\n\n    this.attributes.hp.max = 20\n    this.attributes.power = 5\n    this.attributes.size = 10\n    this.attributes.range.value = 50\n    this.attributes.range.max = 50\n    this.attributes.attackPeriod = 0\n\n    Cat.SPRITES.forEach(({ mode, img, width, height, fps }) => {\n      const image = new Image()\n      image.src = img\n      this.sprites.set(mode, new Sprite(image, width, height, fps))\n    })\n  }\n\n  render(delta: number) {\n    const sprite = this.sprites.get(this.mode)\n    sprite?.update(delta)\n    sprite?.draw(this.context, 0, 0, this.direction)\n  }\n\n  move(distance: Point) {\n    super.move(distance)\n    this.mode = Mode.RUNNING\n  }\n\n  stop() {\n    super.stop()\n    this.mode = Mode.IDLE\n    this.enemies\n      .nearestMobilesInRange(this.position, 50)\n      .forEach(enemy => this.attack(enemy))\n  }\n}\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"1H4Ur\")).toString();","import Mobile from \"../mobile/Mobile\"\n\nexport default class CirclingTriangle extends Mobile {\n\n  constructor(\n    context: CanvasRenderingContext2D\n  ) {\n    super(context)\n\n    this.attributes.hp.max = 5\n    this.attributes.power = 5\n    this.attributes.size = 1\n    this.speed = .5\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected update(_: number): void {\n    if (this.enemies.first === null) {\n      return\n    }\n    this.moveToMobile(this.enemies.first)\n    this.attack(this.enemies.first)\n  }\n\n  render(): void {\n    this.context.save()\n    this.context.rotate(this.direction.angle() + Math.PI / 2)\n    this.context.beginPath()\n    this.context.moveTo(0, -5)\n    this.context.lineTo(5, 5)\n    this.context.lineTo(0, 3)\n    this.context.lineTo(-5, 5)\n    this.context.lineTo(0, -5)\n    this.context.fillStyle = \"red\"\n    this.context.fill()\n    this.context.restore()\n    // attacking effect\n    if (this.lastAttack > 200) return\n    this.context.save()\n    this.context.rotate(this.direction.angle() + Math.PI / 2)\n    this.context.beginPath()\n    this.context.moveTo(0, -4)\n    this.context.lineTo(4, 4)\n    this.context.lineTo(0, 2)\n    this.context.lineTo(-4, 4)\n    this.context.lineTo(0, -4)\n    this.context.fillStyle = `rgba(255, 255, 255, ${this.lastAttack / 200})`\n    this.context.fill()\n    this.context.restore()\n  }\n}\n","import Mobile from \"../mobile/Mobile\"\n\nexport default class TargetPoint extends Mobile {\n  private visible = true\n\n  constructor(\n    context: CanvasRenderingContext2D,\n    private source: Mobile,\n  ) {\n    super(context)\n    this.isLiving = false\n  }\n\n  setVisible(visible: boolean) {\n    this.visible = visible\n  }\n\n  render() {\n    if (!this.visible) {\n      return\n    }\n    const dist = this.source.position.subtract(this.position)\n    this.context.beginPath()\n    this.context.moveTo(0, 0)\n    this.context.lineTo(dist.x, dist.y)\n    this.context.strokeStyle = '#FFF'\n    this.context.setLineDash([5, 15])\n    this.context.stroke()\n  }\n}\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"7agUk\")).toString();","import Mobile from \"../mobile/Mobile\";\nimport Sprite from \"../sprite/Sprite\";\n\n\nexport default abstract class SpriteEffectBase extends Mobile {\n\n  constructor(\n    context: CanvasRenderingContext2D,\n    private sprite: Sprite\n  ) {\n    super(context)\n    this.isLiving = false\n  }\n\n  protected checkLifetimeEnd(): boolean {\n    return this.sprite.loopCount > 0\n  }\n\n  protected render(delta: number): void {\n    this.sprite.update(delta)\n    this.sprite.draw(this.context, 0, 0, this.direction)\n  }\n}\n","import Sprite from \"../sprite/Sprite\"\nimport EffectSprite from \"../../../assets/images/confetti-sprites.png\"\nimport SpriteEffectBase from \"./SpriteEffectBase\"\n\nexport default class ConfettiEffect extends SpriteEffectBase {\n  constructor(\n    context: CanvasRenderingContext2D\n  ) {\n    const image = new Image()\n    image.src = EffectSprite\n    const sprite = new Sprite(image, 81, 81, 10, false)\n    super(context, sprite)\n  }\n\n  protected render(delta: number): void {\n    this.context.save()\n    const gap = this.direction.unit().multiply(30)\n    this.context.translate(gap.x, gap.y)\n    // sprite is facing left, so rotate 90 degrees to face up\n    this.context.rotate(this.direction.angle() + Math.PI / 2)\n    super.render(delta)\n    this.context.restore()\n  }\n}\n","import Point from \"../core/math/Point\"\n\nexport default class Space {\n  width = 0\n  height = 0\n  starElapsed = 0\n  backgroundColor = \"rgb(10, 10, 10)\"\n  starColorRange = 100\n  stars: Point[] = []\n  maxStars = 400\n\n  constructor(\n    private context: CanvasRenderingContext2D\n  ) {\n  }\n\n  animate(delta: number) {\n    this.render(delta)\n  }\n\n  private render(delta: number) {\n    this.renderBackground()\n    this.renderStars()\n\n    if (this.checkStarElapsed(delta)) {\n      this.updateStars()\n    }\n  }\n\n  private renderBackground() {\n    this.context.fillStyle = this.backgroundColor\n    this.context.fillRect(0, 0, this.width, this.height)\n  }\n\n  private renderStars() {\n    this.context.fillStyle = \"white\"\n    this.stars.forEach(star => {\n      this.context.fillRect(star.x, star.y, 1, 1)\n    })\n  }\n\n  private updateStars() {\n    this.stars = []\n    for (let i = 0; i < this.maxStars; i++) {\n      this.stars.push(new Point(\n        Math.random() * this.width,\n        Math.random() * this.height,\n      ))\n    }\n  }\n\n  private checkStarElapsed(delta: number) {\n    this.starElapsed += delta\n    if (this.starElapsed > 200) {\n      this.starElapsed = 0\n      return true\n    }\n    return false\n  }\n}\n","import Game from \"../Game\";\n\nexport default class GameLevel {\n  constructor(\n    private game: Game,\n  ) {\n  }\n\n  update(): void {\n    this.createEnemy()\n  }\n\n  private createEnemy() {\n    if (this.game.player.enemies.length >= 10) return\n    this.game.createEnemy()\n  }\n}\n","import Cat from \"./characters/Cat\"\nimport CirclingTriangle from \"./characters/CirclingTriangle\"\nimport TargetPoint from \"./characters/TargetPoint\"\nimport Point from \"./core/math/Point\"\nimport ConfettiEffect from \"./effects/ConfettiEffect\"\nimport Mobile from \"./mobile/Mobile\"\nimport Space from \"./space/Space\"\nimport GameLevel from \"./stage/GameLevel\"\n\nexport default class Game {\n  options = {\n    showCoordinates: false,\n  }\n  width = 0\n  height = 0\n  lastTime = 0\n  delta = 0\n  space: Space\n  player: Mobile\n  targetPoint: TargetPoint\n  mobiles: Mobile[] = []\n  gameLevel = new GameLevel(this)\n\n  constructor(\n    private context: CanvasRenderingContext2D,\n  ) {\n    this.space = new Space(context)\n    this.player = new Cat(context)\n    this.targetPoint = new TargetPoint(context, this.player)\n    this.mobiles.push(this.targetPoint)\n  }\n\n  resize(width: number, height: number) {\n    this.width = width\n    this.height = height\n    this.space.width = width\n    this.space.height = height\n  }\n\n  animate(time: number) {\n    this.updateDelta(time)\n    this.updateGameLevel()\n    this.updateNonPlayerMobiles()\n    this.updatePlayer()\n    this.context.restore()\n  }\n\n  movePlayer(x: number, y: number) {\n    const distance = new Point(x, y)\n    this.player.move(distance)\n    this.targetPoint.position = this.player.position.add(distance)\n    this.targetPoint.setVisible(true)\n  }\n\n  stopPlayer() {\n    this.player.stop()\n    this.targetPoint.setVisible(false)\n    this.createCatAttackEffect()\n  }\n\n  getSummary() {\n    return `\n      Player:\n        * pos: ${this.player.position.x}, ${this.player.position.y}\n        * hp : ${this.player.attributes.hp.value} / ${this.player.attributes.hp.max}\n      Mobiles: ${this.mobiles.length}\n    `\n  }\n\n  createEnemy() {\n    const enemy = new CirclingTriangle(this.context)\n    enemy.position.x = Math.random() * 1000 - 500\n    enemy.position.y = Math.random() * 1000 - 500\n    enemy.enemies.add(this.player)\n    this.player.enemies.add(enemy)\n    this.mobiles.push(enemy)\n  }\n\n  private updatePlayer() {\n    this.context.save()\n    this.context.translate(this.width / 2, this.height / 2)\n    this.player.animate(this.delta)\n    this.drawCoordinates(this.player, 20)\n    this.context.restore()\n  }\n\n  private updateNonPlayerMobiles() {\n    this.space.animate(this.delta)\n    const aliveMobiles = this.mobiles.filter(mobile => mobile.isAlive)\n    aliveMobiles.forEach(enemy => {\n      this.context.save()\n      this.context.translate(\n        this.width / 2 - this.player.position.x + enemy.position.x,\n        this.height / 2 - this.player.position.y + enemy.position.y,\n      )\n      enemy.animate(this.delta)\n      this.drawCoordinates(enemy, 10, 5)\n      this.context.restore()\n    })\n  }\n\n  private updateGameLevel() {\n    this.gameLevel.update()\n  }\n\n  private updateDelta(time: number) {\n    this.delta = time - this.lastTime\n    this.lastTime = time\n  }\n\n  private createCatAttackEffect() {\n    const effect = new ConfettiEffect(this.context)\n    effect.position = this.player.position\n    effect.direction = this.player.direction\n    effect.onLifetimeEnd = () => {\n      this.mobiles.splice(this.mobiles.indexOf(effect), 1)\n    }\n    this.mobiles.push(effect)\n  }\n\n  private drawCoordinates(mobile: Mobile, margin: number, size = 8) {\n    if (!this.options.showCoordinates || !mobile.isLiving) {\n      return\n    }\n    this.context.fillStyle = \"white\"\n    this.context.font = `${size}px Arial`\n    const text = `${Math.round(mobile.position.x)}, ${Math.round(mobile.position.y)}`\n    const left = text.length / 4 * size\n    this.context.fillText(text, -left, margin)\n  }\n}\n","import Point from \"./game/core/math/Point\"\nimport Game from \"./game/Game\"\n\nexport class App {\n  canvas: HTMLCanvasElement\n  context: CanvasRenderingContext2D\n  game: Game\n  width = 0\n  height = 0\n  keys: string[] = []\n\n  constructor() {\n    this.canvas = document.createElement(\"canvas\")\n    const context = this.canvas.getContext(\"2d\")\n    if (!context) {\n      throw new Error(\"Could not get canvas context\")\n    }\n    this.context = context\n    this.game = new Game(this.context)\n  }\n\n  start() {\n    document.body.appendChild(this.canvas)\n    window.addEventListener(\"resize\", this.resize.bind(this))\n    this.registerCanvasEvents()\n    this.resize()\n    this.animate()\n  }\n\n  enableDebugMode(): App {\n    this.game.options.showCoordinates = true\n    setInterval(() => {\n      console.log(this.game.getSummary())\n    }, 5000)\n    return this\n  }\n\n  private animate(delta = 0) {\n    this.game.animate(delta)\n    requestAnimationFrame(this.animate.bind(this))\n  }\n\n  private resize() {\n    this.width = document.body.clientWidth\n    this.height = document.body.clientHeight\n    this.canvas.width = this.width\n    this.canvas.height = this.height\n\n    this.game.resize(this.width, this.height)\n  }\n\n  private registerCanvasEvents() {\n    this.canvas.addEventListener(\"mousedown\", this.onMouseDown.bind(this))\n    this.canvas.addEventListener(\"mousemove\", this.onMouseMove.bind(this))\n    this.canvas.addEventListener(\"mouseup\", this.onTouchEnd.bind(this))\n    this.canvas.addEventListener(\"touchstart\", this.onTouchStart.bind(this))\n    this.canvas.addEventListener(\"touchmove\", this.onTouchStart.bind(this))\n    this.canvas.addEventListener(\"touchend\", this.onTouchEnd.bind(this))\n    document.addEventListener(\"keydown\", this.onKeyDown.bind(this))\n    document.addEventListener(\"keyup\", this.onKeyUp.bind(this))\n  }\n\n  private onMouseDown(event: MouseEvent) {\n    this.game.movePlayer(\n      ...this.calculateDistanceFromCenter(event.clientX, event.clientY)\n    )\n  }\n\n  private onMouseMove(event: MouseEvent) {\n    if (event.buttons === 0)\n      return\n    this.game.movePlayer(\n      ...this.calculateDistanceFromCenter(event.clientX, event.clientY)\n    )\n  }\n\n  private onTouchStart(event: TouchEvent) {\n    this.game.movePlayer(\n      ...this.calculateDistanceFromCenter(event.touches[0].clientX, event.touches[0].clientY)\n    )\n  }\n\n  private onTouchEnd() {\n    this.game.stopPlayer()\n  }\n\n  private calculateDistanceFromCenter(x: number, y: number): [number, number] {\n    const center = new Point(this.width / 2, this.height / 2)\n    const point = new Point(x, y)\n    const distance = point.subtract(center)\n    return [distance.x, distance.y]\n  }\n\n  private onKeyDown(event: KeyboardEvent) {\n    if (!(event.key in App.KEY_TO_DIRECTION)) {\n      return\n    }\n    if (this.keys.includes(event.key)) {\n      return\n    }\n    this.keys.push(event.key)\n    this.updateKeys()\n  }\n\n  private onKeyUp(event: KeyboardEvent) {\n    if (!(event.key in App.KEY_TO_DIRECTION)) {\n      return\n    }\n    this.keys = this.keys.filter(key => key !== event.key)\n    this.updateKeys()\n  }\n\n  private updateKeys() {\n    if (this.keys.length === 0) {\n      this.game.stopPlayer()\n      return\n    }\n    const sum = this.keys.reduce((sum, key) => {\n      return [sum[0] + App.KEY_TO_DIRECTION[key][0], sum[1] + App.KEY_TO_DIRECTION[key][1]]\n    }, [0, 0])\n    this.game.movePlayer(sum[0], sum[1])\n  }\n\n  static KEY_TO_DIRECTION: { [key: string]: [number, number] } = {\n    \"w\": [0, -1],\n    \"a\": [-1, 0],\n    \"s\": [0, 1],\n    \"d\": [1, 0],\n    \"ArrowUp\": [0, -1],\n    \"ArrowLeft\": [-1, 0],\n    \"ArrowDown\": [0, 1],\n    \"ArrowRight\": [1, 0],\n  }\n}\n\nnew App().enableDebugMode().start()\n"],"names":["$18c11f3350a906ea$export$6503ec6e8aabbaf","$18c11f3350a906ea$export$f7ad0328861e2f03","$18c11f3350a906ea$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$43bfe6294afb6043$export$2e2bcd8739ae039","constructor","x","y","this","static","add","point","subtract","unit","zero","Math","sqrt","multiply","scalar","angle","atan2","distanceTo","limit","max","$6bfbb6c15128e9b5$export$2e2bcd8739ae039","hp","$6bfbb6c15128e9b5$var$NumericAttribute","of","size","power","range","attackPeriod","damage","source","value","_value","_max","min","$e17df336da1b3802$export$2e2bcd8739ae039","collection","filter","mobile","isAlive","first","includes","push","nearestMobilesInRange","position","$73c3f5d8867f376c$export$2e2bcd8739ae039","context","velocity","speed","direction","lifetime","maxLifetime","Infinity","isLiving","attributes","lastAttack","enemies","animate","delta","updateEssentials","update","render","move","distance","moveToMobile","target","stop","margin","dest","attack","isOpponent","checkLifetimeEnd","onLifetimeEnd","_","$da5fc1c35aff1e0d$export$2e2bcd8739ae039","image","frameWidth","frameHeight","framesPerSecond","loop","frameIndex","time","framesPerRow","imageLoaded","loopCount","onload","floor","width","dt","checkLoop","height","draw","ctx","row","col","flip","save","scale","drawImage","restore","$e2c9dcac0f02a629$exports","URL","resolve","import","meta","url","toString","$85c94ce00cb2a82b$var$Mode","Mode","$7357178c6a7828df$exports","$85c94ce00cb2a82b$export$2e2bcd8739ae039","sprites","Map","mode","IDLE","img","$parcel$interopDefault","fps","RUNNING","super","SPRITES","forEach","Image","src","set","sprite","get","enemy","$1680c37e97ccc699$export$2e2bcd8739ae039","rotate","PI","beginPath","moveTo","lineTo","fillStyle","fill","$593fdb6cc61fd03e$export$2e2bcd8739ae039","visible","setVisible","dist","strokeStyle","setLineDash","stroke","$1d5b3938f41b967b$exports","$1f66de5e70c11fdb$export$2e2bcd8739ae039","$8f889751dfd7c577$export$2e2bcd8739ae039","gap","translate","$f8daf18d7ca6e6d0$export$2e2bcd8739ae039","starElapsed","backgroundColor","starColorRange","stars","maxStars","renderBackground","renderStars","checkStarElapsed","updateStars","fillRect","star","random","$2db6e0bd5690816b$export$2e2bcd8739ae039","game","createEnemy","player","$1d65543a723a8bec$export$2e2bcd8739ae039","options","showCoordinates","lastTime","mobiles","gameLevel","space","targetPoint","resize","updateDelta","updateGameLevel","updateNonPlayerMobiles","updatePlayer","movePlayer","stopPlayer","createCatAttackEffect","getSummary","drawCoordinates","effect","splice","indexOf","font","text","round","left","fillText","$2ae89aad8d89d959$export$86fbec116b87613f","canvas","document","createElement","getContext","start","body","appendChild","window","addEventListener","bind","registerCanvasEvents","enableDebugMode","setInterval","console","log","requestAnimationFrame","clientWidth","clientHeight","onMouseDown","onMouseMove","onTouchEnd","onTouchStart","onKeyDown","onKeyUp","event","calculateDistanceFromCenter","clientX","clientY","buttons","touches","center","key","KEY_TO_DIRECTION","updateKeys","sum","reduce","w","a","s","d","ArrowUp","ArrowLeft","ArrowDown","ArrowRight"],"version":3,"file":"index.248050c4.js.map"}